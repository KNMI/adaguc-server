find_package(LibXml2 REQUIRED)
find_package(Cairo REQUIRED)
find_package(Freetype REQUIRED)
find_package(NetCDF REQUIRED)
find_package(Threads REQUIRED)
find_package(PNG REQUIRED)
find_package(PROJ REQUIRED)
find_package(UDUNITS2 REQUIRED)
find_package(GD REQUIRED)
find_package(CURL)
find_package(HDF5 REQUIRED)
find_package(PostgreSQL REQUIRED)
find_package(GDAL REQUIRED)
find_package(SQLite3 REQUIRED)
find_package(WebP REQUIRED)

add_library(
    adagucserverEC
    CAreaMapper.cpp
    CAreaMapper.h
    CAutoConfigure.cpp
    CAutoConfigure.h
    CAutoResource.cpp
    CAutoResource.h
    CCairoPlotter.cpp
    CCairoPlotter.h
    CColor.h
    CConvertADAGUCPoint.cpp
    CConvertADAGUCPoint.h
    CConvertADAGUCVector.cpp
    CConvertADAGUCVector.h
    CConvertASCAT.cpp
    CConvertASCAT.h
    CConvertCurvilinear.cpp
    CConvertCurvilinear.h
    CConvertEProfile.cpp
    CConvertEProfile.h
    CConvertGeoJSON.cpp
    CConvertGeoJSON.h
    CConvertHexagon.cpp
    CConvertHexagon.h
    CConvertKNMIH5EchoToppen.cpp
    CConvertKNMIH5EchoToppen.h
    CConvertKNMIH5VolScan.cpp
    CConvertKNMIH5VolScan.h
    CConvertTROPOMI.cpp
    CConvertTROPOMI.h
    CConvertUGRIDMesh.cpp
    CConvertUGRIDMesh.h
    CCreateHistogram.cpp
    CCreateHistogram.h
    CCreateScaleBar.cpp
    CCreateScaleBar.h
    CCreateTiles.cpp
    CCreateTiles.h
    CDBAdapterPostgreSQL.cpp
    CDBAdapterPostgreSQL.h
    CDBAdapterSQLLite.cpp
    CDBAdapterSQLLite.h
    CDBFactory.cpp
    CDBFactory.h
    CDBFileScanner.cpp
    CDBFileScanner.h
    CDBFileScannerCleanFiles.cpp
    CDFObjectStore.cpp
    CFillTriangle.cpp
    CConvertASCAT.cpp
    CConvertUGRIDMesh.cpp
    CConvertADAGUCVector.cpp
    CConvertEProfile.cpp
    CConvertADAGUCPoint.cpp
    CImgRenderers/CImgRenderPoints.cpp
    CConvertCurvilinear.cpp
    CConvertHexagon.cpp
    CConvertKNMIH5VolScan.cpp
    CInspire.cpp
    CGetFileInfo.cpp
    CStyleConfiguration.cpp
    CMakeJSONTimeSeries.cpp
    COpenDAPHandler.cpp
    CDataPostProcessors/CDataPostProcessor_ClipMinMax.h
    CDataPostProcessors/CDataPostProcessor_ClipMinMax.cpp
    CDataPostProcessors/CDataPostProcessor_Operator.h
    CDataPostProcessors/CDataPostProcessor_Operator.cpp
    CDataPostProcessors/CDataPostProcessor_SolarTerminator.h
    CDataPostProcessors/CDataPostProcessor_SolarTerminator.cpp
    CDataPostProcessors/solar/solar_terminator.h
    CDataPostProcessors/solar/solar_terminator.cpp
    CDataPostProcessors/CDataPostProcessor_IncludeLayer.h
    CDataPostProcessors/CDataPostProcessor_IncludeLayer.cpp
    CDataPostProcessors/CDataPostProcessor.h
    CDataPostProcessors/CDataPostProcessor.cpp
    CDBFactory.cpp
    CDBAdapterPostgreSQL.cpp
    CAutoResource.cpp
    CDBAdapterSQLLite.cpp
    COctTreeColorQuantizer.cpp
    CLegendRenderers/CCreateLegend.cpp
    CCreateHistogram.cpp
    CNetCDFDataWriter.cpp
    CAutoConfigure.cpp
    CMakeEProfile.cpp
    CImgRenderStippling.cpp
    CConvertGeoJSON.cpp
    CGeoJSONData.cpp
    CCreateScaleBar.cpp
    CConvertTROPOMI.cpp
    CImgRenderPolylines.cpp
    CAreaMapper.cpp
    CSLD.cpp
    CHandleMetadata.cpp
    CDPPGoes16Metadata.cpp
    CDataPostProcessors/CDataPostProcessor.cpp
    CDataPostProcessors/CDataPostProcessor.h
    CDataPostProcessors/CDataPostProcessor_ClipMinMax.cpp
    CDataPostProcessors/CDataPostProcessor_ClipMinMax.h
    CDataPostProcessors/CDataPostProcessor_IncludeLayer.cpp
    CDataPostProcessors/CDataPostProcessor_IncludeLayer.h
    CDataPostProcessors/CDataPostProcessor_Operator.cpp
    CDataPostProcessors/CDataPostProcessor_Operator.h
    CDataReader.cpp
    CDataReader.h
    CDataSource.cpp
    CDataSource.h
    CDrawFunction.cpp
    CDrawFunction.h
    CDrawImage.cpp
    CDrawImage.h
    CFillTriangle.cpp
    CFillTriangle.h
    CGDALDataWriter.cpp
    CGDALDataWriter.h
    CGenericDataWarper.cpp
    CGenericDataWarper.h
    CGeoJSONData.cpp
    CGeoJSONData.h
    CGeoParams.cpp
    CGeoParams.h
    CGetFileInfo.cpp
    CGetFileInfo.h
    CHandleMetadata.cpp
    CHandleMetadata.h
    CImageDataWriter.cpp
    CImageDataWriter.h
    CImageWarper.cpp
    CImageWarper.h
    CImgRenderPolylines.cpp
    CImgRenderPolylines.h
    CImgRenderStippling.cpp
    CImgRenderStippling.h
    CImgRenderers/CImgRenderPoints.cpp
    CImgRenderers/CImgRenderPoints.h
    CImgWarpBilinear.cpp
    CImgWarpBilinear.h
    CImgWarpBoolean.cpp
    CImgWarpBoolean.h
    CImgWarpGeneric.cpp
    CImgWarpGeneric.h
    CImgWarpHillShaded.cpp
    CImgWarpHillShaded.h
    CImgWarpNearestNeighbour.cpp
    CImgWarpNearestNeighbour.h
    CImgWarpNearestRGBA.cpp
    CImgWarpNearestRGBA.h
    CInspire.cpp
    CInspire.h
    CLegendRenderers/CCreateLegend.cpp
    CLegendRenderers/CCreateLegend.h
    CMakeEProfile.cpp
    CMakeEProfile.h
    CMakeJSONTimeSeries.cpp
    CMakeJSONTimeSeries.h
    CNetCDFDataWriter.cpp
    CNetCDFDataWriter.h
    COGCDims.cpp
    COGCDims.h
    COctTreeColorQuantizer.cpp
    COctTreeColorQuantizer.h
    COpenDAPHandler.cpp
    COpenDAPHandler.h
    CPGSQLDB.cpp
    CPGSQLDB.h
    CRectangleText.cpp
    CRectangleText.h
    CRequest.cpp
    CRequest.h
    CSLD.cpp
    CSLD.h
    CServerError.cpp
    CServerError.h
    CServerParams.cpp
    CServerParams.h
    CStyleConfiguration.cpp
    CStyleConfiguration.h
    CUniqueRequests/CUniqueRequests.cpp
    CXMLGen.cpp
    CXMLGen.h
    CXMLSerializerInterface.cpp
    CXMLSerializerInterface.h
    json.c
    json.h
    testadagucserver.cpp
)

target_include_directories(adagucserverEC PUBLIC ${CMAKE_CURRENT_SOURCE_DIR} ${Cairo_INCLUDE_DIRS} ${FREETYPE_INCLUDE_DIRS} ${PostgreSQL_INCLUDE_DIRS} ${GDAL_INCLUDE_DIRS} ${PROJ_INCLUDE_DIR})
target_link_libraries(adagucserverEC CCDFDataModel hclasses ${NetCDF_LIBRARIES} ${HDF5_LIBRARIES} ${Cairo_LIBRARIES} ${FREETYPE_LIBRARIES} ${LIBXML2_LIBRARY} Threads::Threads ${PNG_LIBRARY} ${PROJ_LIBRARIES} ${UDUNITS2_LIBRARIES} ${GD_LIBRARIES} ${CURL_LIBRARIES} ${SQLite3_LIBRARIES} ${GDAL_LIBRARIES} ${PostgreSQL_LIBRARIES} ${WebP_LIBRARIES})

# Build unit test executable
add_executable(testadagucserver testadagucserver.cpp)
target_link_libraries(testadagucserver PRIVATE adagucserverEC CCDFDataModel hclasses CppUnitLite)
